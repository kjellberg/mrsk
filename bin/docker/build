#!/bin/sh

# Find MRSK's root directory
SCRIPT_PATH=$(realpath $0)
MRSK_ROOT=$(dirname $(dirname $(dirname $SCRIPT_PATH)))

# Get current MRSK version number
VERSION=$(grep -m1 -o 'VERSION = ".*"' $MRSK_ROOT/lib/mrsk/version.rb | sed 's/VERSION = "\(.*\)"/\1/')

# Set the 'MRSK_IMAGE' to the Docker image name
MRSK_IMAGE="ghcr.io/mrsked/mrsk:v$VERSION"

# Build and tag docker image
docker build -t "$MRSK_IMAGE" "$MRSK_ROOT"
